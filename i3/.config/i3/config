# This file has been auto-generated by i3-config-wizard(1).
# It will not be overwritten, so edit it as you like.
#
# Should you change your keyboard layout somewhen, delete
# this file and re-run i3-config-wizard(1).
#

# i3 config file (v4)
#
# Please see http://i3wm.org/docs/userguide.html for a complete reference!

# Mod1 is WinKey, Mod4 Alt (Note I've swapped Win<->Alt keys at system level)
set $mod Mod1

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below. ISO 10646 = Unicode
#font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1
# The font above is very space-efficient, that is, it looks good, sharp and
# clear in small sizes. However, if you need a lot of unicode glyphs or
# right-to-left text rendering, you should instead use pango for rendering and
# chose a FreeType font.
font pango:Ubuntu Nerd Font 10


# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# start a terminal
bindsym $mod+Return exec urxvt

# kill focused window
bindsym $mod+Shift+q kill

# start dmenu (a program launcher)
#bindsym $mod+d exec dmenu_run
# There also is the (new) i3-dmenu-desktop which only displays applications
# shipping a .desktop file. It is a wrapper around dmenu, so you need that
# installed.
bindsym $mod+d exec rofi -show run -lines 10 -eh 1.3 -opacity "85" -bw 0 -font "System San Francisco Display 12"

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# alternatively, you can use the cursor keys:
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# split in horizontal orientation - h taken, so go with x for stack along x axis
bindsym $mod+x split h

# split in vertical orientation, go with y as consistent with x for horiz
bindsym $mod+y split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
#bindsym $mod+d focus child

# switch to workspace
# I've adden number in here, delete this from each line of probs
bindsym $mod+1 workspace number 1:Web 
bindsym $mod+2 workspace number 2:MailMusic ﭵ
bindsym $mod+3 workspace number 3:Bash 
bindsym $mod+4 workspace number 4:PDFs 
bindsym $mod+5 workspace number 5:Bash 
bindsym $mod+6 workspace number 6:Port 
bindsym $mod+7 workspace number 7:Anki
bindsym $mod+8 workspace number 8:pWeb 
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number 1:Web 
bindsym $mod+Shift+2 move container to workspace number 2:MailMusic ﭵ
bindsym $mod+Shift+3 move container to workspace number 3:Bash 
bindsym $mod+Shift+4 move container to workspace number 4:PDFs 
bindsym $mod+Shift+5 move container to workspace number 5:Bash 
bindsym $mod+Shift+6 move container to workspace number 6:Port 
bindsym $mod+Shift+7 move container to workspace number 7:Anki
bindsym $mod+Shift+8 move container to workspace number 8:pWeb 
bindsym $mod+Shift+9 move container to workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10

# reload the configuration file
bindsym $mod+Shift+c reload
# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart
# exit i3 (logs you out of your X session)
bindsym $mod+Shift+e exec "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'"

# resize window (you can also use the mouse for that)
mode "resize" {
        # These bindings trigger as soon as you enter the resize mode

        # Pressing left will shrink the window’s width.
        # Pressing right will grow the window’s width.
        # Pressing up will shrink the window’s height.
        # Pressing down will grow the window’s height.
        bindsym h resize shrink width 5 px or 5 ppt
        bindsym j resize grow height 5 px or 5 ppt
        bindsym k resize shrink height 5 px or 5 ppt
        bindsym l resize grow width 5 px or 5 ppt

        # same bindings, but for the arrow keys
        bindsym Left resize shrink width 5 px or 5 ppt
        bindsym Down resize grow height 5 px or 5 ppt
        bindsym Up resize shrink height 5 px or 5 ppt
        bindsym Right resize grow width 5 px or 5 ppt

        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
}

bindsym $mod+r mode "resize"

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
		# Issue with FontAwesome missing symbol asfter instaling latex (fonts extra)
		# Think it installed earlier version wthat is getting picked up in pref
		# Instead use patched Nerd Fonts.  Non monospace looks better.
		font pango:Ubuntu Nerd Font 10.5
		status_command i3status

		# Autohide bar: had issues w window switching so didn't use
		#mode hide
		#hidden_state hide
		#modifier Mod1
}

######################## IRB Changes ##########################################

# Remove titlebar
new_window 1pixel
#new_float 1pixel
hide_edge_borders vertical

#Toggle workspace
workspace_auto_back_and_forth yes

# Cycle through active workspaces
bindsym $mod+Tab workspace next
bindsym $mod+Shift+Tab workspace prev

#Set background image
exec --no-startup-id feh --bg-scale /usr/share/backgrounds/linuxmint-sarah/bartosova_aurora.jpg 

# Try to fix bug that show colored bars at bottom right of terminal windws
# Caused by terminal application not painting background on all of canvas
# Set background color in i3 so bits not painted match
#client.background #342826


# ASSIGN SPECIFIC PROGRAMS AS FLOATING
# To get class run ~/bin/i3/get-window-criteria then select win with arrows
for_window [class="Gcalctool"] floating enable
#for_window [class="KeePass2" title="Database"] floating enable
for_window [class="Gnome-encfs-manager"] floating enable
for_window [class="Synaptic"] floating enable
#for_window [class="Thunar"] floating enable
for_window [class="Skype"] floating enable
# Think focus bit below stops this stealing focus.  Some debate as to whether , or ;
# Was getting titlebar issues so changed to ;
for_window [class="Xfce4-notifyd"] floating enable, border none, focus mode-toggle
for_window [class="Pavucontrol"] floating enable
for_window [class="keepassxc"] floating enable

# ASSIGN WORKSPACES TO SPECIFIC PROGRAMS
# Start from 5 as unlikely to be used after that, keep 1-4 Ad Hoc
#assign [class="libreoffice-calc"] 6:Port  <-----stopped working after libreoffice6, use for_window
for_window [class="libreoffice-calc"] move to workspace 6:Port 
for_window [class="libreoffice-calc"] focus
assign [class="Anki" title="Anki - User 1"] 7:Anki
for_window [class="Anki" title="Anki - User 1"] focus
assign [class="Anki" title="Add"] 1
#As window changes title after init, assert doesn;t work.  Use for_window as below
for_window [title=".*\(Private Browsing\).*"] move to workspace 8:pWeb 
for_window [title=".*\(Private Browsing\).*"] focus
# Recompiled mupDF and diesn't have class or name set. Use title that contains pdf.
assign [class="MuPDF"] 4:PDFs 
for_window [class="MuPDF"] focus
assign [class="Zathura"] 4:PDFs 
for_window [class="Zathura"] focus
# Can't use container for mpv as closes once mpv finishes.  Instead define Portfolio container to
# have a mark and use that, additionally set portfolio layout to slitv
# Ionly want to apply to windows in 1st workspace. Having issue shrinking to correct size, seems can't do 400 
for_window [class="mpv" workspace="^1.*"] move window to mark _portfolio, resize shrink height 200, resize shrink height 200
for_window [class="vlc" workspace="^1.*"] move window to mark _portfolio, resize shrink height 200, resize shrink height 200


# Startup Applets
exec --no-startup-id pa-applet
#exec --no-startup-id gnome-encfs-manager
exec --no-startup-id udiskie --tray 
# if wifi issue, use 'nmcli dev wifi' and 'nmcli device wifi connect APname Password'
# OR restart via 'sudo service network-namager restart'
exec --no-startup-id nm-applet

#Start with USB keyboard which is US
#exec --no-startup-id "setxkbmap -model pc105 -layout us"
# Difficulty in starting in .profile/.Xdefaults.  Concluded does run but gets ovweritten.  So run here.

# Start other programs, combine with layouts.  
# Note don't need to specify workspace as json layouts should swallow corect prog
# After much experimentation, it appears that need to:
# 1) USe name rather than title
# 2) Give every terminal a name, otherwise start openeing in random places.
# https://www.reddit.com/r/i3wm/comments/655mey/how_to_make_programs_execute_automatically_on/

# Load Workspace files
exec --no-startup-id "i3-msg 'workspace 1:Web ; append_layout /home/iain/.config/i3/workspace-1.json'"
exec --no-startup-id "i3-msg 'workspace 2:MailMusic ﭵ; append_layout /home/iain/.config/i3/workspace-2.json'"

# Start Programs
# Note on urxvt terminal progs, they're not picking up base16 color scheme
# Think this is as either (i) bashrc not ran OR (ii) Thre is no terminal prompt
# I'll instead keep come colour definitions in .Xdefaults
# After progfram terminated the ';bash -i' loads new terminal that does pick up base16
exec  --no-startup-id "/usr/bin/urxvt -name 'mutt' -e bash -c 'bash -i'"
exec  --no-startup-id "/usr/bin/urxvt -name 'cmus' -e bash -c 'bash -i'"
exec --no-startup-id "/usr/bin/urxvt -name 'Portfolio' -e bash -c '/home/iain/scripts/portfolio.py;bash -i'"
exec --no-startup-id /usr/bin/firefox 

# Shutdown script from https://faq.i3wm.org/question/239/how-do-i-suspendlockscreen-and-logout/ 
set $mode_system System (l) lock, (e) Logout, (s) Shutdown, (h) Hibernate, (r) Reboot, (Shift+s) Suspend
mode "$mode_system" {
    bindsym l exec --no-startup-id i3exit lock, mode "default"
    bindsym e exec --no-startup-id i3exit logout, mode "default"
    bindsym Shift+s exec --no-startup-id i3exit suspend, mode "default"
    bindsym h exec --no-startup-id i3exit hibernate, mode "default"
    bindsym r exec --no-startup-id i3exit reboot, mode "default"
    bindsym s exec --no-startup-id i3exit shutdown, mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym Mod4+s  mode "$mode_system"

# Media player controls
bindsym XF86AudioPlay exec cmus-remote --pause
bindsym XF86AudioPause exec cmu-remote --pause 
bindsym XF86AudioNext exec cmus-remote  --next
bindsym XF86AudioPrev exec cmus-remote  --prev

# Shortcuts
bindsym $mod+F1 exec --no-startup-id /usr/bin/keepass2 
bindsym $mod+F2 exec --no-startup-id /home/iain/bin/LaunchProgs/rport
bindsym $mod+F3 exec --no-startup-id /usr/bin/anki 
bindsym $mod+F4 exec --no-startup-id /usr/bin/gnome-calculator 
bindsym $mod+F7 exec --no-startup-id /usr/bin/firefox
bindsym $mod+F10 exec --no-startup-id /home/iain/bin/playUrl.sh
bindsym $mod+F12 exec --no-startup-id /home/iain/bin/volume.sh

